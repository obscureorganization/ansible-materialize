---
# tasks file for bacula-client
#
# Borrowed partly from https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html#playbooks-best-practices

- name: be sure bacula-client is installed
  yum:
    name: bacula-client
    state: installed
  tags: bacula-client

- name: Fix up bacula-client config
  template:
    src: bacula-fd.conf.j2
    dest: /etc/bacula/bacula-fd.conf
    owner: root
    group: root
    mode: 0640
  tags: bacula-client

- name: Open firewall
  firewalld:
    zone: public
    port: 9102/tcp
    permanent: yes
    immediate: yes
    state: enabled

- name: be sure bacula-client is running and enabled
  service:
    name: bacula-fd
    state: restarted
    enabled: yes
  tags: bacula-client

